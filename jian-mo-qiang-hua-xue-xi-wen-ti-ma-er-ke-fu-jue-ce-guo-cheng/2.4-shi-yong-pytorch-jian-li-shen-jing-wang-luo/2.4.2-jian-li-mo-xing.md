# 2.4.2-建立模型

在本书的大部分时间里，我们不会费心直接处理自动计算的梯度。相反，我们将使用PyTorch的神经网络模块轻松地建立一个前馈神经网络模型，然后使用内置的优化算法自动训练神经网络，而不必手动指定反向传播和梯度下降的机制。这是一个简单的两层神经网络与优化设置:

```text
model = torch.nn.Sequential(
    torch.nn.Linear(10, 150),
    torch.nn.ReLU(),
    torch.nn.Linear(150, 4),
    torch.nn.ReLU(),
)
loss_fn = torch.nn.MSELoss()
optimizer = torch.optim.Adam(model.parameters(), lr=0.01)
```

我们用ReLU\(矫正线性单元\)激活函数建立了双层模型，定义了均方误差损失函数，并建立了优化器。我们所要做的就是训练这个模型，假设我们有一些标记的训练数据，开始一个训练循环:

```text
for step in range(100):
    y_pred = model(x)
    loss = loss_fn(y_pred, y_correct)
    optimizer.zero_grad()
    loss.backward()
    optimizer.step()
```

变量x是模型的输入数据。y\_correct变量是一个张量，表示已标记的正确输出。我们利用模型进行预测，然后计算损失，然后在计算图\(几乎总是损失函数\)的最后一个节点上使用backward\(\)方法计算梯度。

然后我们只在优化器上运行step\(\)方法，它将运行一个梯度下降步骤。如果我们需要构建比顺序模型更复杂的神经网络体系结构，我们可以编写自己的Python类，继承PyTorch的模块类，并使用它代替:









