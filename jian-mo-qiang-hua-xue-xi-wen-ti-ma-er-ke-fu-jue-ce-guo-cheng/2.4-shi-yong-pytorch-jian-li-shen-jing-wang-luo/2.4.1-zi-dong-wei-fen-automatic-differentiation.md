# 2.4.1-自动微分\(Automatic differentiation\)

我们需要PyTorch最重要的特性而numpy没有提供的是自动微分和优化。假设我们想要建立一个简单的线性模型来预测一些感兴趣的数据。我们可以使用普通的numpy类语法轻松地定义模型:

```text
x = torch.Tensor([2,4]) # 输入数据
m = torch.randn(2, requires_grad=True) # 参数1
b = torch.randn(1, requires_grad=True) # 参数2
y = m * x + b # 线性模型
loss = (torch.sum(y_known - y)) ** 2 # 损失函数
m.grad

output:
tensor([ 0.7734, -90.4993])
```

只需向希望计算梯度的PyTorch张量提供requires\_grad=True参数，然后在计算图的最后一个节点上调用backward\(\)方法，该方法将向所有具有requires\_grad=True的节点反向传播梯度。然后，您可以使用自动计算的梯度进行梯度下降。



