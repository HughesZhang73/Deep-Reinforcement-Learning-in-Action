# 2.1-弦图和教学方法

根据我们的经验，当大多数人试图教一些复杂的东西时，他们倾向于按照主题对象本身发展的相反顺序来教。他们会给你一堆定义，术语，描述，也许还有定理，之后，他们会说:“太好了，现在我们已经学习了所有的理论，我们来进行一些实际问题。”“在我们看来，这恰恰是事情应该呈现的相反顺序。大多数好的想法都是作为现实问题的解决方案出现的，或者至少是想象出来的问题。解决问题的人偶然发现一个潜在的解决方案，测试它，改进它，然后最终将它形式化，甚至可能将它数学化。术语和定义是在问题的解决方案被开发出来之后才出现的。

我们认为，当你取代了思考如何解决某个特定问题的最初的创意创造者时，学习是最有动力和最有效的。**只有当解决方案具体化后，它才能保证形式化**，这对于确定其正确性并忠实地与该领域的其他人交流确实是必要的。

我们一直强烈要从事这种倒序的教学模式，并在我们进行的过程中发展这个话题。本着这一精神，我们将根据需要引入新的术语、定义和数学符号。例如，我们会这样使用“插图”：

{% hint style="info" %}
**定义：**

神经网络是一种由多个“层”组成的机器学习模型，执行矩阵向量相乘，然后应用非线性“激活”函数。神经网络的矩阵是模型的可学习参数，通常称为 神经网络的“权重”
{% endhint %}

假如你还是在校学生，每个学期你只会看一次这些标注以及定义，但我们会经常在文本中以不同的方式重复定义，以确保你真正理解和记住它。这是一门关于强化学习的课程，不是教科书或参考资料，所以当我们认为一些重要的事情需要记住时，我们会进行不同方式的重复。

每当我们需要引入一些数学知识时，我们通常会使用一个方框来显示数学知识和相同基础概念的 伪python代码版本。有时用代码或数学来思考会更容易一些，我们认为熟悉这两者是很好的。作为一个超级简单的例子，如果我们要引入直线方程，我们会这样做:

<table>
  <thead>
    <tr>
      <th style="text-align:left">&#x6570;&#x5B66;&#x516C;&#x5F0F;(Math)</th>
      <th style="text-align:left">&#x4F2A;&#x4EE3;&#x7801;(Pseudocode)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left"><b>y = mx + b</b>
      </td>
      <td style="text-align:left">
        <p>def line(x, m, b):</p>
        <p>return m * x + b</p>
      </td>
    </tr>
  </tbody>
</table>

我们还将包括大量的内联代码\(简短的代码片段\)和代码清单\(较长的代码示例\)，以及完整项目的代码。书中所有的代码都可以在jupiter笔记本中找到，该笔记本按本书GitHub存储库中的章节\(http://mng.bz/JzKp\)。如果您正在积极地遵循本书中的文本和构建项目，我们强烈建议您使用这个Github代码库中的代码,而不是直接拷贝书中的代码,我们将保持GitHub代码的更新和无bug，然而随着我们使用的Python库的更新，书中的代码可能会有点过时。GitHub的代码也更完整\(例如，向你展示如何生成我们包含的可视化\)，而文本中的代码尽可能少，以关注底层的概念。

{% hint style="warning" %}
这里译者打算使用章节附录的形式进行代码的运行和记录,在每章节的最后会有代码部分,当然fork本书的代码最好不过
{% endhint %}

由于强化学习涉及到许多相互关联的概念，当仅仅使用词语时，这些概念可能会让人感到困惑，所以我们将包括许多不同种类的图表和图形。我们要用到的最重要的图形是弦图。这也许是一个奇怪的名字，但它确实是一个简单的想法，并改编自范畴论 \(Category theory\)，一个我们在第一章提到的数学分支，他们倾向于使用大量的图表来补充或取代传统的符号符号.

当我们在第一章中介绍强化学习的一般框架时，您已经在图2.1中看到了弦图。其思路是，方框包含名词或名词短语，而箭头则标记为动词或动词短语。它与典型的流程图略有不同，但这使得将字符串图翻译成英文文本和反过来翻译字符串图变得很容易。每个箭头的功能也很清楚。这种特殊的字符串图也被称为本体论日志\(ontological log\)，或olog\(“oh-log”\)。感兴趣的可以深入研究.

![2.1](../.gitbook/assets/image%20%2847%29.png)

一种标准的强化学习模型，在这个模型中，一个agent在一个不断进化的环境中采取行动，并产生奖励来强化agent的行动。

更普遍地说，弦图\(有时在其他来源中被称为连接图\)是类似流的图，表示沿着字符串\(即有向或无向箭头\)进入过程\(计算、函数、转换、过程等\)的类型化数据流，这些过程被表示为框。弦图和您可能已经看到的其他类似的流程图之间的重要区别是弦上的所有数据都是显式类型化的\(例如，形状为\[10\]的numpy数组，或者可能是一个浮点数\)，图表是完全组成的。通过组合，我们的意思是我们可以放大或缩小图表，以看到更大更抽象的图像，或者深入到计算细节。

如果我们显示一个高层次的描述,流程框可能只是用一个词或短语标记指示的过程发生,但是我们也可以显示这个过程的放大视图框,显示所有的内部细节,组合成了自己的一组子字符串和子流程。这些图的组成性质也意味着我们可以将一个图的部分插入到另一个图中，形成更复杂的图，只要所有弦的类型都是兼容的。例如，这是一个单一的神经网络层作为一个字符串图:

![](../.gitbook/assets/image%20%2845%29.png)

从左到右读取，我们看到一些类型n的数据流入一个称为神经网络层的处理框，并产生类型m的输出。由于神经网络通常以向量作为输入，并产生向量作为输出，这些类型分别指输入向量和输出向量的维数。也就是说，这个神经网络层接受一个长度或维数为n的向量，并产生一个维数为m的向量。 对于某些神经网络层，n = m是可能的.

这种输入\(typing\)弦的方式得到了简化，我们只在从上下文清楚类型的含义时才这样做。在其他情况下，我们可以使用数学符号，例如 _**R**_ 对于所有实数的集合，这在编程语言中基本上转换为浮点型数,所以对于具有n维向量的浮点型数向量,我们可以用这种方式输入\(Typing\)弦:

![](../.gitbook/assets/image%20%2843%29.png)

现在类型更丰富了，我们不仅知道输入和输出向量的维数，还知道它们是实数/浮点数。虽然通常情况下都是这样，但有时我们可能要处理整数或二进制数。无论如何，我们的神经网络层处理盒\(Neural Network Layer process box\)作为一个黑盒留在那里;我们不知道里面到底发生了什么,除了它把一个向量变换成另一个不同维数的向量。我们可以决定放大这个过程，看看具体发生了什么:

![](../.gitbook/assets/image%20%2846%29.png)

现在我们可以看到原始流程框的内部，它由自己的一组子流程组成。我们可以看到，我们的n维向量乘以一个维数为 n × m 的矩阵，就得到了一个 m 维向量乘积。然后这个向量会经过一个叫做“ReLU”的过程，你可能会认为这是一个标准的神经网络激活函数，即矫正线性单元。如果我们愿意，我们可以继续放大ReLU子进程。任何称为弦图的必须能够在任何抽象层上经得起检查以及在任何级别上保持完整的类型\(well typed\)\(这意味着输入和输出进程的数据类型必须兼容并有意义,例如应该产生有序列表\(sorted lists\)的进程不应该与期望得到整数的另一个进程连接在一起\)。

只要字符串具有良好的类型，我们就可以将一组过程串成一个复杂的系统。这允许我们只构建一次组件，并在任何类型匹配的地方重用它们。在较高的层次上，我们可以这样描述一个简单的两层递归神经网络\(RNN\):

![](../.gitbook/assets/image%20%2844%29.png)

这个RNN接受一个 _**q**_ 向量并产生一个 _**s**_ 向量。但是，我们可以看到内部的过程。它有两层，每一层的功能看起来都一样。它们都接受一个向量并产生一个向量，除了输出向量被复制并作为输入的一部分反馈到层过程中，因此上述是递归形式。

弦图是一种非常普遍的图;除了绘制神经网络图，我们还可以用它们绘制如何烘烤蛋糕的图。计算图\(computational graph\)是一种特殊的字符串图，其中所有的过程代表了计算机可以执行的具体计算，或者可以用一些编程语言\(如Python\)来描述。如果你曾经可视化过一个计算图表 TensorFlow的TensorBoard，你会知道我们的意思\(两者是类似的\).好的弦图的目标是我们可以在高层次上查看一个算法或机器学习模型的概览,然后逐渐放大,直到弦图足够详细,几乎完全基于我们对图的了解去最终实现算法.

在数学、简单的Python代码和我们将在本书中呈现的弦图之间，你理解如何实现一些相当先进的机器学习模型应该没有问题。

