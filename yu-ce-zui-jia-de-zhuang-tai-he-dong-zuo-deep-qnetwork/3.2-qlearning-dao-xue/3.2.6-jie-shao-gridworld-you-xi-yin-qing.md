# 3.2.6-介绍Gridworld游戏引擎

在本章的GitHub存储库中，你会找到一个名为Gridworld.py的文件。把这个文件复制粘贴到你要工作的任何文件夹里。你可以通过运行Gridworld import \*将它包含在你的Python会话中。Gridworld模块包含一些类和帮助函数，用于运行Gridworld游戏实例。要创建Gridworld游戏实例，请运行下面清单中的代码。

```text
from Gridworld import Gridworld
game = Gridworld(size=4, mode='static')
```

Gridworld面板总是正方形的，因此大小指的是一条边维度大小, 在本例中将创建一个4×4的网格。初始化游戏板有三种方法。第一种方法是静态地初始化它，如清单3.1所示，以便在相同的预定位置对板上的对象进行初始化。其次，你可以设mode='player'，这样玩家就会初始化在棋盘上的随机位置。最后，你可以使用mode='random'将它初始化，这样所有的对象都是随机放置的\(这对于算法来说比较难学习\)。我们最终将使用全部三个选项来进行相应的训练。

现在我们已经创建了游戏，让我们来玩吧。调用display方法显示板，调用makeMove方法进行移动。移动是用单个字母编码的: u表示向上，l表示向左，等等。每走一步之后，你应该展示棋盘，看看效果。此外，在每次移动后，你应该显示游戏版去观察效果, 你会想要通过调用奖励方法来观察移动的奖励或者输出。在《Gridworld》中，每一次未获胜的移动都将获得-1奖励。获胜的移动\(达到目标\)将获得+10奖励，失败的移动\(落在坑上\)将获得-10奖励。

```text
>>> game.display()
array([['+', '-', ' ', 'P'],
[' ', 'W', ' ', ' '],
[' ', ' ', ' ', ' '],
[' ', ' ', ' ', ' ']], dtype='<U2')

>>> game.makeMove(‘d’)
>>> game.makeMove(‘d’)
>>> game.makeMove(‘l’)
>>> game.display()
array([['+', '-', ' ', ' '],
[' ', 'W', ' ', ' '],
[' ', ' ', 'P', ' '],
[' ', ' ', ' ', ' ']], dtype='<U2')

>>> game.reward()
-1
```

现在, 让我们看看游戏状态最终如何表示的, 因为我们需要把这些输入到神经网络中,执行以下命令:

```text
>>> game.board.render_np()
array([[[0, 0, 0, 0],
[0, 0, 0, 0],
[0, 0, 1, 0],
[0, 0, 0, 0]],
[[1, 0, 0, 0],
[0, 0, 0, 0],
[0, 0, 0, 0],
[0, 0, 0, 0]],
[[0, 1, 0, 0],
[0, 0, 0, 0],
[0, 0, 0, 0],
[0, 0, 0, 0]],
[[0, 0, 0, 0],
[0, 1, 0, 0],
[0, 0, 0, 0],
[0, 0, 0, 0]]], dtype=uint8)

>>> game.board.render_np().shape
(4, 4, 4)
```

状态被表示为一个4×4×4张量，其中第一个维度指的是大小为4×4的四个矩阵的集合。你可以用高度和宽度来表示帧的尺寸。每个矩阵是一个4×4的网格，由0和一个单一的1组成，其中1表示特定对象的位置。每个矩阵编码四个对象中的一个的位置:玩家、目标、坑和墙。如果你比较的结果显示游戏状态,您可以看到,第一个矩阵编码的位置的球员,第二个矩阵编码目标的位置,第三个矩阵编码坑的位置,最后矩阵编码墙的位置。

换句话说，这个3张量的第一个维度被分为四个单独的网格平面，每个平面代表每个元素的位置。图3.7显示了一个例子，即玩家处于网格位置\(2,2\)，目标是\(0,0\)，坑是\(0,1\)，墙是\(1,1\)，而平面是\(行，列\)。其他元素都是0。

![&#x56FE;3.7](../../.gitbook/assets/image%20%2888%29.png)

{% hint style="info" %}
这就是Gridworld的游戏板表示为 numpy 数组的方式。它是一个4×4×4张量，由4×4网格的4个“切片”组成。每个网格切片代表一个单独的对象在板上的位置，并包含一个单一的1，所有其他元素为0。1的位置表示该切片对象的位置
{% endhint %}

虽然我们可以，原则上，建立一个可以作用于4×4×4张量的神经网络，但把它平坦成一个1张量\(一个向量\)更容易。一个4×4×4张量有4^3 = 64个总元素，因此我们的神经网络的输入层必须设置成相应的形状。 神经网络必须了解这些数据意味着什么，以及它与最大化奖励之间的关系。记住，算法一开始什么都不知道。





















